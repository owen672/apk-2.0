<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Patinaje App Móvil</title>
<meta name="theme-color" content="#0b0b0c" />
<style>
:root{
  --bg:#0b0b0c;
  --card:#121315;
  --muted:#8d8f98;
  --primary:#22c55e;
  --primary-ink:#191919;
  --success:#22c55e;
  --danger:#ef4444;
  --stroke:#232428;
  --shadow:0 10px 30px rgba(0,0,0,.35);
  --radius:16px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
  background:radial-gradient(1200px 800px at 50% -200px,#1a1b1f 0%,var(--bg) 40%), var(--bg);
  color:#f5f7fb;
}
.app{min-height:100dvh; max-width:820px; margin:0 auto; display:flex; flex-direction:column;}
header{
  position:sticky; top:0; z-index:40;
  display:flex; align-items:center; gap:.85rem; padding:14px 16px; background:rgba(10,10,11,.85);
  backdrop-filter: blur(8px); border-bottom:1px solid var(--stroke);
}
.logo{width:34px; height:34px; border-radius:12px; background:linear-gradient(135deg, var(--primary), #76e29f); color:#111; display:grid; place-items:center; font-weight:900}
.title{font-weight:800; letter-spacing:.2px}
.title small{display:block; color:var(--muted); font-weight:600; margin-top:-2px}

.screen{padding:16px; display:none;}
.screen.active{display:block}

.news-grid{display:grid; gap:12px}
.card{background:linear-gradient(180deg,#17181b,#0f1012); border:1px solid var(--stroke); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden}
.card .media{height:140px; background:#0d0e10; display:block}
.card .media img{width:100%; height:100%; object-fit:cover}
.card .body{padding:14px}
.eyebrow{color:var(--muted); font-size:.75rem; letter-spacing:.3px; text-transform:uppercase}
.card h3{margin:6px 0 6px; font-size:1.05rem}
.card p{margin:0; color:#cfd3dc; font-size:.95rem}
.btn-row{position:sticky; bottom:0; left:0; right:0; display:grid; grid-template-columns:repeat(4,1fr); gap:10px; padding:12px 16px; background:linear-gradient(180deg, transparent, rgba(0,0,0,.45) 30%, rgba(0,0,0,.7));}
.btn{appearance:none; border:none; border-radius:14px; padding:12px 14px; font-weight:800; cursor:pointer}
.btn.primary{background:linear-gradient(180deg,var(--primary),#76e29f); color:#161616}
.btn.ghost{background:#181a1d; color:#f7f9ff; border:1px solid var(--stroke)}

dialog{border:none; border-radius:18px; background:linear-gradient(180deg,#15161a,#0f1012); color:#fff; width:min(520px, 92vw); box-shadow:var(--shadow);}
dialog::backdrop{background:rgba(0,0,0,.55)}
.form{display:grid; gap:12px; padding:16px}
.field{display:grid; gap:6px}
label{font-size:.9rem; color:#e5e7ef}
input, select, textarea{width:100%; padding:12px 12px; border-radius:12px; border:1px solid var(--stroke); background:#0e0f12; color:#fff}

.tabs{display:flex; gap:8px; border-bottom:1px solid var(--stroke); margin-bottom:12px}
.tab{padding:10px 12px; border-radius:12px; border:1px solid var(--stroke); background:#121317; cursor:pointer; font-weight:700; color:#dbe0ec}
.tab.active{background:linear-gradient(180deg,#1d1f24,#111216); border-color:#2a2b31}

.profile{display:grid; gap:12px}
.chip{display:inline-flex; align-items:center; gap:8px; padding:6px 10px; border-radius:999px; border:1px solid var(--stroke); font-size:.85rem; color:#cfd3dc}
.row{display:flex; gap:12px; flex-wrap:wrap}
.grow{flex:1 1 200px}
table{width:100%; border-collapse:collapse; background:#0f1012; border:1px solid var(--stroke); border-radius:14px; overflow:hidden}
th,td{padding:12px 10px; border-bottom:1px solid var(--stroke); text-align:left}
th{background:#131419}
.status{font-weight:900; padding:6px 10px; border-radius:999px; display:inline-block}
.paid{background:rgba(34,197,94,.15); color:#86efac; border:1px solid rgba(34,197,94,.35)}
.due{background:rgba(239,68,68,.15); color:#fecaca; border:1px solid rgba(239,68,68,.35)}
.pending{background:rgba(253,224,71,.15); color:#fef08a; border:1px solid rgba(253,224,71,.35)}
.footer-space{height:18vh}
.right{justify-self:end}
.divider{height:1px; background:var(--stroke); margin:8px 0}
.muted{color:var(--muted)}
.center{text-align:center}
.hidden{display:none !important}
</style>
</head>
<body>
<div class="app" id="app">
<header>
  <div class="logo">⛸️</div>
  <div class="title">Patinaje LAT App <small class="muted">Noticias • Tiempos • Pagos</small></div>
  <button id="logoutBtn" class="btn ghost right hidden" title="Cerrar sesión">Salir</button>
</header>

<!-- NOTICIAS / LANDING -->
<section id="newsScreen" class="screen active">
  <h2 style="margin:6px 0 12px">Noticias de Patinaje</h2>
  <p class="muted" style="margin-top:-6px">Resumen rápido pensado para móvil.</p>
  <div id="newsList" class="news-grid"></div>
  <div class="btn-row">
    <button class="btn ghost" id="openRegisterAthlete">Registro Deportista</button>
    <button class="btn primary" id="openLoginAthlete">Login Deportista</button>
    <button class="btn ghost" id="openRegisterTrainer">Registro Entrenador</button>
    <button class="btn primary" id="openLoginTrainer">Login Entrenador</button>
  </div>
</section>

<!-- DASHBOARD -->
<section id="dashboard" class="screen">
  <div id="trainerSelectContainer"></div>
  <div class="tabs" role="tablist">
    <button class="tab active" data-tab="perfil">Perfil</button>
    <button class="tab" data-tab="tiempos">Tiempos</button>
    <button class="tab" data-tab="pagos">Pagos</button>
    <button class="tab" data-tab="comentarios">Comentarios</button>
  </div>
  <div id="tab-perfil" class="tabpanel">
    <div class="row">
      <div class="card grow">
        <div class="body" id="perfilBody">
          <!-- Contenido dinámico -->
        </div>
      </div>
    </div>
  </div>
  <div id="tab-tiempos" class="tabpanel hidden">
    <div class="card">
      <div class="body">
        <div class="row" style="align-items:end">
          <div class="grow">
            <label class="muted">Distancia</label>
            <input id="distInput" placeholder="200m / 400m / 1km" />
          </div>
          <div class="grow">
            <label class="muted">Tiempo (mm:ss.ms)</label>
            <input id="timeInput" placeholder="00:28.45" />
          </div>
          <button class="btn ghost" id="addTime">Agregar</button>
        </div>
      </div>
    </div>
    <div class="card" style="margin-top:12px">
      <div class="body">
        <h3 style="margin-top:0">Tabla de mejores tiempos</h3>
        <table id="timesTable">
          <thead><tr><th>Distancia</th><th>Mejor tiempo</th><th>Fecha</th><th></th></tr></thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>
  <div id="tab-pagos" class="tabpanel hidden">
    <div class="card">
      <div class="body">
        <div class="row" style="align-items:center">
          <div class="grow">
            <h3 style="margin:0">Estado de pago</h3>
            <div id="payStatus" class="status pending">Pendiente</div>
            <p class="muted" id="payNote" style="margin-top:8px">Sube el comprobante o marca como pagado.</p>
          </div>
          <select id="payState">
            <option value="pending">Pendiente</option>
            <option value="paid">Pagado</option>
            <option value="due">En mora</option>
          </select>
        </div>
        <div class="row" style="margin-top:10px">
          <input type="file" id="payReceipt" accept="image/*,application/pdf" class="grow" />
          <button class="btn ghost" id="savePayment">Guardar</button>
        </div>
      </div>
    </div>
  </div>
  <div id="tab-comentarios" class="tabpanel hidden">
    <div class="card">
      <div class="body">
        <div id="commentsList" class="profile" style="max-height:40vh; overflow:auto"></div>
        <div class="divider"></div>
        <div class="row">
          <input id="commentInput" class="grow" placeholder="Comentario del profesor..." />
          <button class="btn primary" id="addComment">Agregar</button>
        </div>
      </div>
    </div>
  </div>
  <div class="footer-space"></div>
</section>

<!-- DIALOGS -->
<dialog id="dlgRegister">
  <form method="dialog" class="form" id="registerForm">
    <h3>Registro</h3>
    <div class="field">
      <label>Tipo de usuario</label>
      <select id="userTypeSelect">
        <option value="athlete">Deportista</option>
        <option value="trainer">Entrenador</option>
      </select>
    </div>
    <div class="field">
      <label>Nombre</label>
      <input type="text" id="regName" required />
    </div>
    <div class="field">
      <label>Contraseña</label>
      <input type="password" id="regPass" required />
    </div>
    <menu>
      <button class="btn ghost" id="cancelReg">Cancelar</button>
      <button class="btn primary" id="submitReg">Registrar</button>
    </menu>
  </form>
</dialog>

<dialog id="dlgLogin">
  <form method="dialog" class="form" id="loginForm">
    <h3>Iniciar sesión</h3>
    <div class="field">
      <label>Tipo de usuario</label>
      <select id="loginTypeSelect">
        <option value="athlete">Deportista</option>
        <option value="trainer">Entrenador</option>
      </select>
    </div>
    <div class="field">
      <label>Nombre</label>
      <input type="text" id="loginName" required />
    </div>
    <div class="field">
      <label>Contraseña</label>
      <input type="password" id="loginPass" required />
    </div>
    <menu>
      <button class="btn ghost" id="cancelLogin">Cancelar</button>
      <button class="btn primary" id="submitLogin">Ingresar</button>
    </menu>
  </form>
</dialog>

<script>
// ====== Noticias demo ======
// ====== Noticias demo con imágenes ======
const newsList = document.getElementById('newsList');
const noticiasDemo = [
  {title:"Copa Tintal 2025 se acerca", desc:"Todo listo para la gran competencia.", img:"https://via.placeholder.com/400x140/22c55e/000000?text=Copa+Tintal"},
  {title:"Entrenamientos intensivos", desc:"Nuevos programas de preparación.", img:"https://via.placeholder.com/400x140/22c55e/000000?text=Entrenamientos"},
  {title:"Patinaje sobre ruedas", desc:"Tips para mejorar velocidad y técnica.", img:"https://via.placeholder.com/400x140/22c55e/000000?text=Patinaje"},
];

noticiasDemo.forEach(n => {
  const card = document.createElement('div'); card.className='card';
  card.innerHTML=`
    <div class="media"><img src="${n.img}" alt="${n.title}"></div>
    <div class="body">
      <h3>${n.title}</h3>
      <p>${n.desc}</p>
    </div>
  `;
  newsList.appendChild(card);
});
// ====== Screens ======
const newsScreen = document.getElementById('newsScreen');
const dashboard = document.getElementById('dashboard');

// ====== Dialogs ======
const dlgRegister = document.getElementById('dlgRegister');
const dlgLogin = document.getElementById('dlgLogin');

document.getElementById('openRegisterAthlete').onclick=()=>{dlgRegister.showModal(); userTypeSelect.value='athlete'}
document.getElementById('openRegisterTrainer').onclick=()=>{dlgRegister.showModal(); userTypeSelect.value='trainer'}
document.getElementById('openLoginAthlete').onclick=()=>{dlgLogin.showModal(); loginTypeSelect.value='athlete'}
document.getElementById('openLoginTrainer').onclick=()=>{dlgLogin.showModal(); loginTypeSelect.value='trainer'}
document.getElementById('cancelReg').onclick=()=>dlgRegister.close();
document.getElementById('cancelLogin').onclick=()=>dlgLogin.close();

// ====== LocalStorage usuarios ======
let users = JSON.parse(localStorage.getItem('athletes')||'[]');
let trainers = JSON.parse(localStorage.getItem('trainers')||'[]');
let currentUser=null, currentType=null;

// ====== Registro ======
document.getElementById('submitReg').onclick=(e)=>{
  e.preventDefault();
  const name=regName.value.trim(), pass=regPass.value.trim(), type=userTypeSelect.value;
  if(!name||!pass){alert('Complete todos los campos'); return;}
  if(type==='athlete' && users.find(u=>u.name===name)){alert('Ya existe'); return;}
  if(type==='trainer' && trainers.find(u=>u.name===name)){alert('Ya existe'); return;}
  const newUser={name, pass, times:[], payments:{state:'pending', receipt:null}, comments:[]};
  if(type==='athlete'){users.push(newUser); localStorage.setItem('athletes', JSON.stringify(users))}
  else{trainers.push(newUser); localStorage.setItem('trainers', JSON.stringify(trainers))}
  alert('Registrado con éxito'); dlgRegister.close();
};

// ====== Login ======
document.getElementById('submitLogin').onclick=(e)=>{
  e.preventDefault();
  const name=loginName.value.trim(), pass=loginPass.value.trim(), type=loginTypeSelect.value;
  let u=null;
  if(type==='athlete') u=users.find(u=>u.name===name && u.pass===pass);
  else u=trainers.find(u=>u.name===name && u.pass===pass);
  if(!u){alert('Usuario o contraseña incorrecta'); return;}
  currentUser=u; currentType=type;
  dlgLogin.close();
  showDashboard();
};

// ====== Logout ======
document.getElementById('logoutBtn').onclick=()=>{
  currentUser=null; currentType=null;
  dashboard.classList.remove('active'); newsScreen.classList.add('active');
  logoutBtn.classList.add('hidden');
};

// ====== Dashboard ======
const logoutBtn=document.getElementById('logoutBtn');
const tabs=document.querySelectorAll('.tab');
tabs.forEach(t=>{
  t.onclick=()=>{
    tabs.forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    document.querySelectorAll('.tabpanel').forEach(p=>p.classList.add('hidden'));
    document.getElementById('tab-'+t.dataset.tab).classList.remove('hidden');
  };
});

function showDashboard(){
  newsScreen.classList.remove('active');
  dashboard.classList.add('active');
  logoutBtn.classList.remove('hidden');
  renderPerfil();
  renderTimes();
  renderPayment();
  renderComments();
}

// ====== PERFIL ======
const perfilBody=document.getElementById('perfilBody');
function renderPerfil(){
  perfilBody.innerHTML=`<p><strong>Nombre:</strong> <input id="editName" value="${currentUser.name}"/></p>
  <p><strong>Contraseña:</strong> <input type="password" id="editPass" value="${currentUser.pass}"/></p>
  <button class="btn primary" id="saveProfile">Guardar</button>`;
  document.getElementById('saveProfile').onclick=()=>{
    currentUser.name=document.getElementById('editName').value.trim();
    currentUser.pass=document.getElementById('editPass').value.trim();
    saveUsers();
    alert('Perfil guardado');
    renderPerfil();
  };
}

// ====== Tiempos ======
const distInput=document.getElementById('distInput'), timeInput=document.getElementById('timeInput'), timesTable=document.getElementById('timesTable').querySelector('tbody');
document.getElementById('addTime').onclick=()=>{
  const d=distInput.value.trim(), t=timeInput.value.trim();
  if(!d||!t){alert('Complete campos'); return;}
  currentUser.times.push({dist:d,time:t,date:new Date().toLocaleString()});
  saveUsers(); renderTimes();
  distInput.value=''; timeInput.value='';
};
function renderTimes(){
  timesTable.innerHTML='';
  currentUser.times.forEach((tt,i)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${tt.dist}</td><td>${tt.time}</td><td>${tt.date}</td><td><button class="btn ghost" data-i="${i}">Eliminar</button></td>`;
    tr.querySelector('button').onclick=()=>{currentUser.times.splice(i,1); saveUsers(); renderTimes();}
    timesTable.appendChild(tr);
  });
}

// ====== Pagos ======
const payState=document.getElementById('payState'), payStatus=document.getElementById('payStatus'), payNote=document.getElementById('payNote'), payReceipt=document.getElementById('payReceipt');
document.getElementById('savePayment').onclick=()=>{
  currentUser.payments.state=payState.value;
  if(payReceipt.files[0]) currentUser.payments.receipt=payReceipt.files[0].name;
  saveUsers(); renderPayment();
};
function renderPayment(){
  payStatus.className='status '+currentUser.payments.state;
  payStatus.textContent=currentUser.payments.state==='paid'?'Pagado':currentUser.payments.state==='due'?'En mora':'Pendiente';
  payNote.textContent=currentUser.payments.receipt?'Archivo: '+currentUser.payments.receipt:'Sube el comprobante o marca como pagado';
}

// ====== Comentarios ======
const commentsList=document.getElementById('commentsList'), commentInput=document.getElementById('commentInput');
document.getElementById('addComment').onclick=()=>{
  if(commentInput.value.trim()!==''){currentUser.comments.push({text:commentInput.value, date:new Date().toLocaleString()}); commentInput.value=''; saveUsers(); renderComments();}
};
function renderComments(){
  commentsList.innerHTML='';
  currentUser.comments.forEach(c=>{
    const div=document.createElement('div'); div.className='chip';
    div.textContent=`${c.text} (${c.date})`; commentsList.appendChild(div);
  });
}

// ====== Guardar ======
function saveUsers(){
  localStorage.setItem('athletes', JSON.stringify(users));
  localStorage.setItem('trainers', JSON.stringify(trainers));
}
</script>
</body>
</html>
